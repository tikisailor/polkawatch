# Polkawatch Live Query Server

## Introduction

LQS goal is to make the full eleastic search power available via Open API. 

LQS is a generic elastic server based on "templating" by using elastic tools, such as kibana, to model a query and 
using its speficiation as a template that can be parametrized, validated and transformed into a desired final form.

LQS allows for the endpoints to be fully validated and properly specified.

## Technology Stack

LQS is based on the following technology stack

- [elastic search](www.elastic.co)
- [swagger](https://swagger.io)/[openapi](https://www.openapis.org/)
- [nestjs](https://nestjs.com/)
- nodejs/javascript/typescript

## Test Guide

LQS consumes a substrate blockchain index generated by polkawatch archive. However it is possible to run different tests 
with and without a full deployment.

### Unit Testing

```yarn test```

### e2e Integration Testing

You will need a elastic search server that has been populated with polkawatch data. However you can use a test container
with a container dataset as follows:

```$bash
$ docker-compose up
$ yarn test:e2e
```

### e2e Regression Testing

It is possible to record data samples from an elastic search and later run e2e regression with data data. This allows
you to detect regressions during CD/CI and development without requiring a full environment.

You can record samples, while you have access to an elastic search instance, by doing:

```$ yarn test:e2e:record```

Later you can run regression tests as:

```$ yarn test:e2e:regression```

## Adding Queries and Endpoints to LQS

See the [queries documentation](./src/queries/Readme.md).

## Generating Client SDKs

## License

LQS is part of the Polkawatch Project and it is licensed under Apache 2 License.